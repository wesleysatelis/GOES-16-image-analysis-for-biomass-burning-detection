library(tidyverse)
install.packages("tidyverse")
install.packages(c("tmap", "viridis"))
install.packages(c("tmap", "viridis"))
install.packages("classInt")
install.packages("tmap")
install.packages("tmap")
packages <- list("raster", "viridis", "rgdal", "tmap", "sf", "tidyvere", "geobr")
for(i in packages){
if (require(i, quietly) == FALSE){
# print(i)
install.packages(i)
}
}
# check.packages function: install and load multiple R packages.
# Check to see if packages are installed. Install them if they are not, then load them into the R session.
check.packages <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
packages <- c("raster", "viridis", "rgdal", "tmap", "sf", "tidyverse", "geobr")
check.packages(packages)
c2 <- scan(file = paste("201907141630G16.SP_Bandas_2_3--L1B.pic.C02.txt", sep = ""), sep = ",", quiet=T)
c2 <- matrix(c2, byrow= TRUE, ncol = 2110, nrow = 1332)
c3 <- scan(file = paste("201907141630G16.SP_Bandas_2_3--L1B.pic.C03.txt", sep = ""), sep = ",", quiet=T)
c3 <- matrix(c3, byrow= TRUE, ncol = 2110, nrow = 1332)
ndvi <- t(c3-c2)/t(c3+c2)
setwd("~/Dropbox/prod_cient_git/GOES-16-image-analysis-for-biomass-burning-detection")
# check.packages function: install and load multiple R packages.
# Check to see if packages are installed. Install them if they are not, then load them into the R session.
check.packages <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
packages <- c("raster", "viridis", "rgdal", "tmap", "sf", "tidyverse", "geobr")
check.packages(packages)
# setwd("/home/wesley/Desktop/IC/Processamento de imagens/")
# plant <- st_read("ok247/000_SP_Usinas.shp") %>%
#   dplyr::select(MAPA2010, MAPA2010, CNPTIA, CTBE, geometry) %>%
#   tidyr::unite(mapa, MAPA2010:CTBE, sep="-") %>%
#   dplyr::filter(mapa != "NA-NA-NA-NA") %>%
#   dplyr::mutate(mapa = "E")
# rm(plant)
c2 <- scan(file = paste("201907141630G16.SP_Bandas_2_3--L1B.pic.C02.txt", sep = ""), sep = ",", quiet=T)
c2 <- matrix(c2, byrow= TRUE, ncol = 2110, nrow = 1332)
c3 <- scan(file = paste("201907141630G16.SP_Bandas_2_3--L1B.pic.C03.txt", sep = ""), sep = ",", quiet=T)
c3 <- matrix(c3, byrow= TRUE, ncol = 2110, nrow = 1332)
ndvi <- t(c3-c2)/t(c3+c2)
# ======== 15k pontos de interesse ========
# loc_plant <- st_read("/home/wesley/Desktop/Canasat_CS_2012/")
ndvi_rast <- raster(xmn=-53.4948231956, xmx=-43.9471907179, ymn=-25.4224855885, ymx=-19.4198207653, ncols=2110, nrows=1332,
crs="+init=epsg:4326 +proj=longlat +ellps=WGS84")
ndvi_rast <- setValues(ndvi_rast, as.vector(ndvi))
ndvi_rast <- flip(ndvi_rast, 2)
ndvi <- t(c3-c2)/t(c3+c2)
c2 <- scan(file = paste("201907141630G16.SP_Bandas_2_3--L1B.pic.C02.txt", sep = ""), sep = ",", quiet=T)
setwd("~/Dropbox/prod_cient_git/GOES-16-image-analysis-for-biomass-burning-detection")
c2 <- scan(file = paste("201907141630G16.SP_Bandas_2_3--L1B.pic.C02.txt", sep = ""), sep = ",", quiet=T)
c2 <- scan(file = paste("data/201907141630G16.SP_Bandas_2_3--L1B.pic.C02.txt", sep = ""), sep = ",", quiet=T)
c2 <- matrix(c2, byrow= TRUE, ncol = 2110, nrow = 1332)
c3 <- scan(file = paste("data/201907141630G16.SP_Bandas_2_3--L1B.pic.C03.txt", sep = ""), sep = ",", quiet=T)
c3 <- matrix(c3, byrow= TRUE, ncol = 2110, nrow = 1332)
ndvi <- t(c3-c2)/t(c3+c2)
ndvi_rast <- raster(xmn=-53.4948231956, xmx=-43.9471907179, ymn=-25.4224855885, ymx=-19.4198207653, ncols=2110, nrows=1332,
crs="+init=epsg:4326 +proj=longlat +ellps=WGS84")
ndvi_rast <- setValues(ndvi_rast, as.vector(ndvi))
ndvi_rast <- flip(ndvi_rast, 2)
set.seed(13)
loc_plant <- read.table("../../canasat/sp_12.txt") %>%
sample_n(200) %>%
st_as_sf(coords = c(2,1), crs=crs(ndvi_rast, asText=TRUE))
sao_paulo <- read_state("SP", 2016)
sao_paulo <- st_transform(sao_paulo, crs = crs(ndvi_rast, asText=TRUE))
breaks <- seq(-1, 1, by = 0.00001)
rm(c2, c3, packages)
rm(ndvi)
c2 <- scan(file = paste("data/201907141630G16.SP_Bandas_2_3--L1B.pic.C02.txt", sep = ""), sep = ",", quiet=T)
c2 <- matrix(c2, byrow= TRUE, ncol = 2110, nrow = 1332)
c3 <- scan(file = paste("data/201907141630G16.SP_Bandas_2_3--L1B.pic.C03.txt", sep = ""), sep = ",", quiet=T)
c3 <- matrix(c3, byrow= TRUE, ncol = 2110, nrow = 1332)
ndvi <- t(c3-c2)/t(c3+c2)
# ======== 15k pontos de interesse ========
# loc_plant <- st_read("/home/wesley/Desktop/Canasat_CS_2012/")
ndvi_rast <- raster(xmn=-53.4948231956, xmx=-43.9471907179, ymn=-25.4224855885, ymx=-19.4198207653, ncols=2110, nrows=1332,
crs="+init=epsg:4326 +proj=longlat +ellps=WGS84")
# ndvi_rast <- raster(xmn=-53.5, xmx=-44.0, ymn=-25.5, ymx=-19.5, ncols=2110, nrows=1332,
#                     crs='+proj=longlat +ellps=GRS80 +towgs84=0,0,0 +no_defs')
ndvi_rast <- setValues(ndvi_rast, as.vector(ndvi))
ndvi_rast <- flip(ndvi_rast, 2)
set.seed(13)
loc_plant <- read.table("../../canasat/sp_12.txt") %>%
sample_n(200) %>%
st_as_sf(coords = c(2,1), crs=crs(ndvi_rast, asText=TRUE))
sao_paulo <- read_state("SP", 2016)
sao_paulo <- st_transform(sao_paulo, crs = crs(ndvi_rast, asText=TRUE))
breaks <- seq(-1, 1, by = 0.00001)
rm(ndvi, c2, c3)
save.image("~/Dropbox/ic.RData")
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.align = 'center')
load("../../ic.RData")
tm_shape(ndvi_rast) + tm_raster(midpoint = NA, palette = viridis(length(breaks)), style = "cont", title = "NDVI") +
tm_shape(sao_paulo) + tm_borders(col = "white") +
tm_shape(loc_plant) + tm_bubbles(col="red", size = 0.05, alpha=1) +
tm_graticules(col="white", lwd=0.5) +
tm_layout(frame = F, legend.outside = T, legend.outside.position="right", legend.outside.size=0.2)
sao_paulo <- read_state("SP", 2016)
sao_paulo <- st_transform(sao_paulo, crs = crs(ndvi_rast, asText=TRUE))
breaks <- seq(-1, 1, by = 0.00001)
save.image("~/Dropbox/ic.RData")
load("../../ic.RData")
sao_paulo <- st_transform(sao_paulo, crs = crs(ndvi_rast, asText=TRUE))
loc_plant <- st_transform(loc_plant, crs = crs(ndvi_rast, asText=TRUE))
tm_shape(ndvi_rast) + tm_raster(midpoint = NA, palette = viridis(length(breaks)), style = "cont", title = "NDVI") +
tm_shape(sao_paulo) + tm_borders(col = "white") +
tm_shape(loc_plant) + tm_bubbles(col="red", size = 0.05, alpha=1) +
tm_graticules(col="white", lwd=0.5) +
tm_layout(frame = F, legend.outside = T, legend.outside.position="right", legend.outside.size=0.2)
load("../../ic.RData")
ndvi_rast_mtr <- projectRaster(ndvi_rast, crs="+proj=utm +zone=22 +south +datum=WGS84 +units=m +no_defs")
ndvi_rast_mtr <- projectRaster(ndvi_rast, crs="+proj=utm +zone=22 +south +datum=WGS84 +units=m +no_defs")
loc_plant <- st_transform(loc_plant, crs = crs(ndvi_rast_mtr, asText=TRUE))
sao_paulo <- st_transform(sao_paulo, crs = crs(ndvi_rast_mtr, asText=TRUE))
loc_plant_2km <- st_buffer(loc_plant, dis=2000)
ndvi_rast_raio <- crop(ndvi_rast_mtr, filter(loc_plant_2km, row_number() == 13))
tm_shape(ndvi_rast_raio) +
tm_raster(midpoint = NA, palette = viridis(length(breaks)), style = "cont", title="NDVI", interpolate = FALSE) +
tm_layout(legend.outside = T, legend.outside.position = "right", legend.outside.size = 0.1)
ndvi_rast_raio <- crop(ndvi_rast_mtr, filter(loc_plant_2km, row_number() == 11))
tm_shape(ndvi_rast_raio) +
tm_raster(midpoint = NA, palette = viridis(length(breaks)), style = "cont", title="NDVI", interpolate = FALSE) +
tm_layout(legend.outside = T, legend.outside.position = "right", legend.outside.size = 0.1)
ndvi_rast_raio <- crop(ndvi_rast_mtr, filter(loc_plant_2km, row_number() == 10))
tm_shape(ndvi_rast_raio) +
tm_raster(midpoint = NA, palette = viridis(length(breaks)), style = "cont", title="NDVI", interpolate = FALSE) +
tm_layout(legend.outside = T, legend.outside.position = "right", legend.outside.size = 0.1)
ndvi_rast_raio <- crop(ndvi_rast_mtr, filter(loc_plant_2km, row_number() == 1))
tm_shape(ndvi_rast_raio) +
tm_raster(midpoint = NA, palette = viridis(length(breaks)), style = "cont", title="NDVI", interpolate = FALSE) +
tm_layout(legend.outside = T, legend.outside.position = "right", legend.outside.size = 0.1)
ndvi_rast_raio <- crop(ndvi_rast_mtr, filter(loc_plant_2km, row_number() == 15))
tm_shape(ndvi_rast_raio) +
tm_raster(midpoint = NA, palette = viridis(length(breaks)), style = "cont", title="NDVI", interpolate = FALSE) +
tm_layout(legend.outside = T, legend.outside.position = "right", legend.outside.size = 0.1)
load("../../ic.RData")
ndvi_rast_mtr <- projectRaster(ndvi_rast, crs="+proj=utm +zone=22 +south +datum=WGS84 +units=m +no_defs")
ndvi_rast_mtr <- projectRaster(ndvi_rast, crs="+proj=utm +zone=22 +south +datum=WGS84 +units=m +no_defs")
loc_plant <- st_transform(loc_plant, crs = crs(ndvi_rast_mtr, asText=TRUE))
loc_plant <- st_transform(loc_plant, crs = crs(ndvi_rast_mtr, asText=TRUE))
sao_paulo <- st_transform(sao_paulo, crs = crs(ndvi_rast_mtr, asText=TRUE))
loc_plant_2km <- st_buffer(loc_plant, dis=2000)
ndvi_rast_raio <- crop(ndvi_rast_mtr, filter(loc_plant_2km, row_number() == 15))
tm_shape(ndvi_rast_raio) +
tm_raster(midpoint = NA, palette = viridis(length(breaks)), style = "cont", title="NDVI", interpolate = FALSE) +
tm_layout(legend.outside = T, legend.outside.position = "right", legend.outside.size = 0.1)
